<!DOCTYPE html>
<html lang="en">
<style type="text/css">
    .uvideo {
    position: relative;
    height: 0;
    padding-bottom: 56.25%;
}
.uvideo iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100% !important;
    height: 100% !important;

}
.navbar-toggler.hidden-lg-up{visibility: hidden ;}



</style>
  <head>
    <title>應華語文教材：學期</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="Shortcut Icon" type="tm-brand-icon" href="https://lh4.googleusercontent.com/0PuPEfJbnn18l3VEhQdY-lXB6J2eqHuo5gvrQXHI9Oy0OSOcTmfYRPaWedAxNtnUT2p5WTXxHI1hBlgzz1YN5nw=w16383" />
    <!-- load stylesheets -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400">  
    <!-- Google web font "Open Sans" -->
    <link rel="stylesheet" href="font-awesome-4.5.0/css/font-awesome.min.css">       
    <!-- Font Awesome -->
    <link rel="stylesheet" href="css/bootstrap.min.css">                               
    <!-- Bootstrap style -->
    <link rel="stylesheet" href="css/hero-slider-style.css">                            
    <!-- Hero slider style (https://codyhouse.co/gem/hero-slider/) -->
    <link rel="stylesheet" href="css/magnific-popup.css">                               
    <!-- Magnific popup style (http://dimsemenov.com/plugins/magnific-popup/) -->
    <link rel="stylesheet" href="css/templatemo-style.css">                            
    <!-- Templatemo style -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  </head>

<body style="background-color: #000;">
              <!-- Navigation -->   

            <div class="cd-slider-nav">
                <nav class="navbar" >
                    <div class="tm-navbar-bg"> 
                        
                        <a class="navbar-brand text-uppercase" href="#" style="width:100%;"><i class="fa fa-leaf tm-brand-icon" ></i><b>112 學年度作品集</b></a>
                    </div>
                </nav>
            </div> 
            <div style="margin-top:130px;"></div>
                    <div class="cd-full-width" style="margin-top:25px;">
                        <div class="container-fluid js-tm-page-content" data-page-no="2">           
                            <div class="tm-3-col-container"> 
                         <!--     <div class="col-xs-12 col-sm-6  col-lg-4 tm-3-2-col-textbox" style="margin-top:50px;" >
                                <div class="text-xs-left tm-textbox tm-textbox-padding tm-bg-white-translucent tm-3-col-textbox-inner" style="margin:0px auto;">
                                  <div class="hsin" style="text-align: center;"> 
                                    <p style="font-size:x-large;"><b><w class="resultsshow"></w>學年度 作品集</b></p> 
                                  </div>
                                </div>
                              </div>-->
                                        
                                         <p class=results></p>

                              <div class="col-xs-12 col-sm-6  col-lg-4 tm-3-2-col-textbox" style="margin-top:50px;" >
                                
                                    <div class="tm-social-icons-container text-xs-center">
                                      <a href="https://sites.google.com/view/cycuhuayu/page" class="tm-social-link"><i class="fa fa-home"></i></a>
                                      <p class="tm-copyright-text">© 2022 李郁錦老師的華語教學 & 教材遊戲化的異想世界</p>
                                    </div>
                                
                              </div>                                                                   
                            </div>
                        </div>         
                    </div> 


<script>

        fetch('https://sheets.googleapis.com/v4/spreadsheets/1PrDp_RoaolEYn-KcBvMOBG6c9Z4CHflyoWOVdnSu7bw/values/工作表1?alt=json&key=AIzaSyDgcwjrY1iZo-7jIdQeEQjXR6ghmC1SOS8')
          .then(res => res.json())
          .then(res => {
            // 處理函式           
            objectResult(res);
          })
          

        const objectResult = object => 
        {
            var many=0;
            var coinshow="📜 獲勝條件：";
            object
            // 確定 object 非 null 且有 values 屬性
            ?.values
            // values 裡面是 array
            // forEach 可以迴圈元素，第二個是索引
            ?.forEach((element, index) =>  // newElement = element.filter(el => !el.includes("組"));   // 篩選如果有"組"這個字就排除，最後形成新陣列
            {

                if (element[4] == "112") {  //助教請修改此位置(1) ex:將１０９改成１１０///
                many=1;
                file = element[3]; 
                year = element[4]; 
                group = element[5]; 
                works = element[6]; 
                works_1 = element[7]; 
                works_2 = element[8]; 
                goal = element[9]; 
                coin = element[10]; 
                learn = element[11]; 
                yesorno = element[12]; 
                answer = element[13]; 
                YT = element[14]; 

                if(element[10]== undefined || element[10]== ""){
                    coinshow ="";
                }else{
                    coinshow ="📜 獲勝條件：";
                }
                
            
                    
                    var Card = `
                    <div class="col-xs-12 col-sm-6  col-lg-4 tm-3-2-col-textbox" style="margin-top:50px;" >
                        <div class="text-xs-left tm-textbox tm-textbox-padding tm-bg-white-translucent tm-3-col-textbox-inner" style="margin:0px auto;">
                            <div class="hsin" style="float:left; margin:10px; min-width:45%;"> 
                                <p style="text-align:center; min-width:250px;">
                                    <b style="font-size:22px; color: #642100;min-width:100%;">${group} - ${works}</b><br>
                                    <p style="font-size:medium; text-align:center;">
                                    <b>學年：</b>${year}&nbsp; 
                                    <b>訓練語言技能：</b>${works_2}&nbsp;
                                    <b>類別：</b>${works_1} &ensp; </p>
                                </p>
                                <div class="uvideo">${YT}</div>
                            </div>
                            <div class="hsin"style="float:left; margin:20px;max-width:45%;">
                                <div style="text-align: justify; text-justify:inter-ideograph;">
                               
                                    <p style="font-size:18px;"><b>📜 遊戲教學目標：</b></p>                        
                                    <p style="font-size:15px;">${goal}</p>
                                    <p style="font-size:18px;"><b>${coinshow}</b></p>
                                    <p style="font-size:15px;">${coin}</p>
                                    <p style="font-size:18px;"><b>📜 教材主要學習內容： </b></p>
                                    <p style="font-size:15px;">${learn}</p>
                                    <p style="font-size:18px;"><b>📜 是否搭配教材： </b></p>
                                    <p style="font-size:15px;">${yesorno}。${answer}</p>
                                    <p style="font-size:18px;"><b><a href="${file}" target="_blank">📥點此下載教材</a></b></p> 
                                </div>
                            </div>
                        </div>
                    </div>
                                                   
              
                `;
                $('.results').append(Card);
                 
                    
                }

                
            });
                if (many==0){

                    var Card = `
                    
                    <div class="col-xs-12 col-sm-6  col-lg-4 tm-3-2-col-textbox" style="margin-top:50px;" >
                        <div class="text-xs-left tm-textbox tm-textbox-padding tm-bg-white-translucent tm-3-col-textbox-inner" style="margin:0px auto;">
                            <div style="float:left; margin:10px; min-width:100%;"> 
                                <p style="text-align:center; min-width:250px;">
                                     <p style="font-size:25px;text-align:center;"><b>語法類 - 教材籌備中....</b></p>
                                </p>
                            </div>
                        </div>
                    </div>
                                                   
              
                `;
                $('.results').append(Card);

                 
                many=1;
                }
        };   // 如果陣列裡第一個是 "A" 或 "C" 則放進 HTML

</script>
</body>
</html>
